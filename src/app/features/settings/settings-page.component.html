<div class="settings-page">
  <div class="settings-header">
    <mat-icon>settings</mat-icon>
    <h2>Settings</h2>
  </div>

  <div class="settings-sections">
    <!-- Theme Section -->
    <section class="settings-section">
      <h3>
        <mat-icon>palette</mat-icon>
        Theme
      </h3>
      <div class="theme-grid">
        @for (theme of availableThemes; track theme.id) {
          <button class="theme-card" [class.active]="currentTheme().id === theme.id" (click)="setTheme(theme.id)">
            <div class="theme-preview" [style.background]="theme.bgPrimary || '#ffffff'">
              <div class="theme-swatch" [style.background]="theme.primary"></div>
            </div>
            <span class="theme-name">{{ theme.name }}</span>
            @if (currentTheme().id === theme.id) {
              <mat-icon class="theme-check">check_circle</mat-icon>
            }
          </button>
        }
      </div>
    </section>

    <mat-divider />

    <!-- Remote Access Section -->
    <section class="settings-section">
      <h3>
        <mat-icon>lan</mat-icon>
        Remote Access
      </h3>
      <p class="section-description">
        Serve the Castle UI over HTTP so you can access it from other devices on your network or Tailscale tailnet.
      </p>

      <div class="setting-row">
        <div class="setting-label">
          <span>Enable remote access</span>
        </div>
        <mat-slide-toggle
          [(ngModel)]="tailscaleEnabled"
          (change)="onToggle()"
          [disabled]="saving">
        </mat-slide-toggle>
      </div>

      @if (tailscaleEnabled) {
        <div class="setting-row port-row">
          <mat-form-field appearance="outline" class="port-field">
            <mat-label>Port</mat-label>
            <input matInput type="number" [(ngModel)]="tailscalePort" min="1024" max="65535">
          </mat-form-field>
          <button mat-stroked-button (click)="applyPort()" [disabled]="saving">
            Apply
          </button>
        </div>

        <div class="status-row">
          @if (tailscaleRunning) {
            <mat-icon class="status-icon running">check_circle</mat-icon>
            <span class="status-text running">
              Running on <code>http://localhost:{{ tailscalePort }}</code>
            </span>
          } @else {
            <mat-icon class="status-icon stopped">radio_button_unchecked</mat-icon>
            <span class="status-text stopped">Not running</span>
          }
        </div>

        @if (tailscaleError) {
          <div class="error-row">
            <mat-icon>error</mat-icon>
            <span>{{ tailscaleError }}</span>
          </div>
        }
      }
    </section>

    <mat-divider />

    <!-- About Section -->
    <section class="settings-section about-section">
      <h3>
        <mat-icon>info</mat-icon>
        About
      </h3>
      <div class="about-card">
        <span class="app-logo">üè∞</span>
        <div class="about-info">
          <span class="app-title">{{ appName }}</span>
          <span class="app-version">Version {{ appVersion }}</span>
        </div>
      </div>
      <p class="section-description">
        A Discord-like desktop app for GitHub Copilot CLI agents.
        Manage multiple AI agents, each with their own personality and capabilities.
      </p>
    </section>
  </div>
</div>
